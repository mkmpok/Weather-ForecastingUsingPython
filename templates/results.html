<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Results</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="container py-4">
  <a href="{{ url_for('index') }}" class="btn btn-link">&larr; Back</a>
  <h3>Weather for {{ place }}</h3>

  <div class="card mb-3 p-3">
    <div>
      <h4>{{ weather.name }} ({{ weather.sys.country }})</h4>
      <p><strong>{{ weather.main.temp }}°C</strong> — {{ weather.weather[0].description }}</p>
      <img src="https://openweathermap.org/img/wn/{{ weather.weather[0].icon }}@2x.png" alt="icon">
      <p>Humidity: {{ weather.main.humidity }}% | Wind: {{ weather.wind.speed }} m/s</p>
    </div>
  </div>

  <h5>Quick 5-day snapshot (sample of 8 * 3-hour blocks)</h5>
  <div class="row">
    {% for item in forecast.list[:8] %}
      <div class="col-md-3">
        <div class="card p-2 mb-2">
          <div>{{ item.dt_txt }}</div>
          <img src="https://openweathermap.org/img/wn/{{ item.weather[0].icon }}@2x.png">
          <div>{{ item.main.temp }}°C</div>
          <div>{{ item.weather[0].description }}</div>
        </div>
      </div>
    {% endfor %}
  </div>

  <hr>
  <h5>Save this search (will store current+forecast payload)</h5>
  <form method="POST" action="{{ url_for('save_record') }}" class="row g-2">
    <input type="hidden" name="lat" value="{{ lat }}">
    <input type="hidden" name="lon" value="{{ lon }}">
    <div class="col-md-6">
      <input class="form-control" name="location_text" value="{{ place }}" required>
    </div>
    <div class="col-md-3">
      <input class="form-control" type="date" name="start_date" required>
    </div>
    <div class="col-md-3">
      <input class="form-control" type="date" name="end_date" required>
    </div>
    <div class="col-12">
      <button class="btn btn-success">Save</button>
    </div>
  </form>
</body>
</html>